!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports,require("@angular/core"),require("@angular/router"),require("@ngxs/store")):"function"==typeof define&&define.amd?define("@ngxs/router-plugin",["exports","@angular/core","@angular/router","@ngxs/store"],e):e((t.ngxs=t.ngxs||{},t.ngxs["router-plugin"]={}),t.ng.core,t.ng.router,t["ngxs-store"])}(this,function(t,e,n,o){"use strict";var i=function d(){},r=function(){function t(){}return t.prototype.serialize=function(t){return{root:this.serializeRoute(t.root),url:t.url}},t.prototype.serializeRoute=function(t){var e=this,r=t.children.map(function(t){return e.serializeRoute(t)});return{url:t.url,params:t.params,queryParams:t.queryParams,fragment:t.fragment,data:t.data,outlet:t.outlet,component:null,routeConfig:null,root:null,parent:null,firstChild:r[0],children:r,pathFromRoot:null,paramMap:t.paramMap,queryParamMap:t.queryParamMap,toString:t.toString}},t}(),a=function(){return(a=Object.assign||function(t){for(var e,r=1,n=arguments.length;r<n;r++)for(var o in e=arguments[r])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)};function u(t,e,r,n){var o,i=arguments.length,a=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,n);else for(var u=t.length-1;0<=u;u--)(o=t[u])&&(a=(i<3?o(a):3<i?o(e,r,a):o(e,r))||a);return 3<i&&a&&Object.defineProperty(e,r,a),a}function s(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)}var c=function(){function t(t,e,r){this.path=t,this.queryParams=e,this.extras=r}return Object.defineProperty(t,"type",{get:function(){return"[Router] Navigate"},enumerable:!0,configurable:!0}),t}(),p=function(){function t(t,e){this.routerState=t,this.event=e}return Object.defineProperty(t,"type",{get:function(){return"[Router] RouterNavigation"},enumerable:!0,configurable:!0}),t}(),l=function(){function t(t,e,r){this.routerState=t,this.storeState=e,this.event=r}return Object.defineProperty(t,"type",{get:function(){return"[Router] RouterCancel"},enumerable:!0,configurable:!0}),t}(),g=function(){function t(t,e,r){this.routerState=t,this.storeState=e,this.event=r}return Object.defineProperty(t,"type",{get:function(){return"[Router] RouterError"},enumerable:!0,configurable:!0}),t}(),f=function(){function t(t,e,r,n){this._store=t,this._router=e,this._serializer=r,this._ngZone=n,this.dispatchTriggeredByRouter=!1,this.navigationTriggeredByDispatch=!1,this.setUpStoreListener(),this.setUpStateRollbackEvents()}var r;return(r=t).state=function(t){return t&&t.state},t.url=function(t){return t&&t.state&&t.state.url},t.prototype.navigate=function(t,e){var r=this;this._ngZone.run(function(){return r._router.navigate(e.path,a({queryParams:e.queryParams},e.extras))})},t.prototype.angularRouterAction=function(t,e){t.setState(a({},t.getState(),{state:e.routerState,navigationId:e.event.id}))},t.prototype.setUpStoreListener=function(){var e=this;this._store.select(r).subscribe(function(t){e.routerState=t}),this._store.select(r.state).subscribe(function(){e.navigateIfNeeded()})},t.prototype.setUpStateRollbackEvents=function(){var e=this;this._router.events.subscribe(function(t){t instanceof n.RoutesRecognized?e.lastRoutesRecognized=t:t instanceof n.ResolveEnd?e.resolveEnd(t.state):t instanceof n.NavigationCancel?e.dispatchRouterCancel(t):t instanceof n.NavigationError&&e.dispatchRouterError(t)})},t.prototype.resolveEnd=function(t){this.routerStateSnapshot=this._serializer.serialize(t),this.shouldDispatchRouterNavigation()&&this.dispatchRouterNavigation()},t.prototype.shouldDispatchRouterNavigation=function(){return!this.routerState||!this.navigationTriggeredByDispatch},t.prototype.navigateIfNeeded=function(){var t=this;this.routerState&&this.routerState.state&&(this.dispatchTriggeredByRouter||this._router.url!==this.routerState.state.url&&(this.navigationTriggeredByDispatch=!0,this._ngZone.run(function(){return t._router.navigateByUrl(t.routerState.state.url)})))},t.prototype.dispatchRouterNavigation=function(){this.dispatchRouterAction(new p(this.routerStateSnapshot,new n.RoutesRecognized(this.lastRoutesRecognized.id,this.lastRoutesRecognized.url,this.lastRoutesRecognized.urlAfterRedirects,this.routerStateSnapshot)))},t.prototype.dispatchRouterCancel=function(t){this.dispatchRouterAction(new l(this.routerStateSnapshot,this.routerState,t))},t.prototype.dispatchRouterError=function(t){this.dispatchRouterAction(new g(this.routerStateSnapshot,this.routerState,new n.NavigationError(t.id,t.url,""+t)))},t.prototype.dispatchRouterAction=function(t){this.dispatchTriggeredByRouter=!0;try{this._store.dispatch(t)}finally{this.dispatchTriggeredByRouter=!1,this.navigationTriggeredByDispatch=!1}},t.decorators=[{type:e.Injectable}],t.ctorParameters=function(){return[{type:o.Store},{type:n.Router},{type:i},{type:e.NgZone}]},u([o.Action(c),s("design:type",Function),s("design:paramtypes",[Object,c]),s("design:returntype",void 0)],t.prototype,"navigate",null),u([o.Action([p,g,l]),s("design:type",Function),s("design:paramtypes",[Object,Object]),s("design:returntype",void 0)],t.prototype,"angularRouterAction",null),u([o.Selector(),s("design:type",Function),s("design:paramtypes",[Object]),s("design:returntype",void 0)],t,"state",null),u([o.Selector(),s("design:type",Function),s("design:paramtypes",[Object]),s("design:returntype",Object)],t,"url",null),t=r=u([o.State({name:"router",defaults:{state:undefined,navigationId:undefined}}),s("design:paramtypes",[o.Store,n.Router,i,e.NgZone])],t)}(),h=function(){function t(){}return t.forRoot=function(){return{ngModule:t}},t.decorators=[{type:e.NgModule,args:[{imports:[o.NgxsModule.forFeature([f])],providers:[{provide:i,useClass:r}]}]}],t}();t.NgxsRouterPluginModule=h,t.RouterState=f,t.RouterStateSerializer=i,t.DefaultRouterStateSerializer=r,t.Navigate=c,t.RouterNavigation=p,t.RouterCancel=l,t.RouterError=g,Object.defineProperty(t,"__esModule",{value:!0})});
//# sourceMappingURL=ngxs-router-plugin.umd.min.js.map